# --- Notes -------------------------------------------------------------------

# - bind is an alias for bind-key, and unbind for unbind-key
# - To reload this configuration with tmux already running:
#   tmux source ~/.tmux.conf



# --- Binds -------------------------------------------------------------------

# Unbind everything so I can have a clean slate
# https://www.ianthehenry.com/posts/how-to-configure-tmux/
unbind -a

# Remaps prefix to C-f
unbind C-b
set -g prefix C-f
bind -N 'Prefix'                            C-f   send-prefix
bind -N 'Reload the configuration file'     R     { source-file ~/.tmux.conf; display-message 'Reloaded!' }
bind -N 'Display active tmux sessions'      C-s   choose-tree -sZ -O 'time' -F '' -K ''
bind -N 'Go to Left pane'                   Left  select-pane -L
bind -N 'Go to Right pane'                  Right select-pane -R
bind -N 'Display original help of bindings' ?     display-popup -w 50% -h 100% ~/display-tmux-bindings.sh
bind -N 'Command prompt'                    :     command-prompt
bind -N 'Slide current window to the left' '{'    { swap-window -t -1; previous-window }
bind -N 'Slide current window to the right' '}'   { swap-window -t +1; next-window }
bind -N 'Split pane horizontally'           /     split-pane -h -c "#{pane_current_path}"
bind -N 'Split pane vertically'             -     split-pane -v -c "#{pane_current_path}"
bind -N 'Tmux Nagivator'                    C-f   display-popup -w 50% -h 100% -E tmux-nav
bind -N 'Equalize panes size'               =     select-layout -E
bind -N 'Close pane'                        x     kill-pane
bind -N 'New window'                        t     new-window 
bind -N 'Kill window'                       X     kill-window 
bind -N 'Rename window'                     F2    command-prompt -p "Rename window:" -I "#W" "rename-window -- '%%'"
bind -N 'Zoom pane'                         z     resize-pane -Z


# Copy
unbind -T copy-mode-vi MouseDragEnd1Pane
#bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-selection
unbind -T copy-mode MouseDragEnd1Pane
#bind -T copy-mode MouseDragEnd1Pane send-keys -X copy-selection
bind -T copy-mode Enter send-keys -X copy-selection-and-cancel



# --- General Configuration ---------------------------------------------------

# Sets a very high history limit
set-option -g history-limit 50000

# Set statusbar position to top
set-option -g status-position top

# Set some title in the iTerm window
set -g set-titles on
set -g set-titles-string "Tmux"

# Pane and Windows numbering start at 1 instead of 0
set -g base-index 1
set -g pane-base-index 1

# Interval (s) in which the screen is reloaded
set -g status-interval 10

# Enable mouse
set -g mouse on

# Move from and to tmux panes and vim panes seamlesly
#bind -n C-h run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-h) || tmux select-pane -L"
#bind -n C-j run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-j) || tmux select-pane -D"
#bind -n C-k run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-k) || tmux select-pane -U"
#bind -n C-l run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-l) || tmux select-pane -R"

# Undercurl - https://github.com/folke/lsp-colors.nvim#making-undercurls-work-properly-in-tmux
set -g default-terminal "${TERM}"
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'  # undercurl support
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'  # underscore colours - needs tmux-3.0



# --- Plugins -----------------------------------------------------------------

# Add new plugin to ~/.tmux.conf with: set -g @plugin 'github-user/repo'
# Press <PREFIX> + I (capital i) to fetch the plugin.

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-online-status'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
# set -g @plugin 'odedlaz/tmux-onedark-theme'

# Onedark Configuration & Setup
set -g @onedark_date_format "%Y-%m-%d"
set -g @onedark_time_format "%T"
run-shell ~/.config/tmux/tmux-onedark-theme.sh

# Tmux Online Status Config -- Shows if you are connected to the internet
set -g @online_icon  "#[fg=#282c34,bg=#98c379]"
set -g @offline_icon "#[fg=#282c34,bg=#e06c75]"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run -b '~/.tmux/plugins/tpm/tpm'

